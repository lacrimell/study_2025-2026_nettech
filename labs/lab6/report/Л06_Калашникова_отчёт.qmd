---
# Preamble

## Author
author:
  name: Калашникова Ольга Сергеевна
  degrees: DSc
  orcid: 0000-0002-0877-7063
  email: kulyabov-ds@rudn.ru
  affiliation:
    - name: Российский университет дружбы народов
      country: Российская Федерация
      postal-code: 117198
      city: Москва
      address: ул. Миклухо-Маклая, д. 6
## Title
title: "Отчёт по лабораторной работе №6"
subtitle: "Дисциплина: Сетевые технологии"
license: "CC BY"
## Generic options
lang: ru-RU
number-sections: true
toc: true
toc-title: "Содержание"
toc-depth: 2
## Crossref customization
crossref:
  lof-title: "Список иллюстраций"
  lot-title: "Список таблиц"
  lol-title: "Листинги"
## Bibliography
bibliography:
  - bib/cite.bib
csl: _resources/csl/gost-r-7-0-5-2008-numeric.csl
## Formats
format:
### Pdf output format
  pdf:
    toc: true
    number-sections: true
    colorlinks: false
    toc-depth: 2
    lof: true # List of figures
    lot: true # List of tables
#### Document
    documentclass: scrreprt
    papersize: a4
    fontsize: 12pt
    linestretch: 1.5
#### Language
    babel-lang: russian
    babel-otherlangs: english
#### Biblatex
    cite-method: biblatex
    biblio-style: gost-numeric
    biblatexoptions:
      - backend=biber
      - langhook=extras
      - autolang=other*
#### Misc options
    csquotes: true
    indent: true
    header-includes: |
      \usepackage{indentfirst}
      \usepackage{float}
      \floatplacement{figure}{H}
      \usepackage[math,RM={Scale=0.94},SS={Scale=0.94},SScon={Scale=0.94},TT={Scale=MatchLowercase,FakeStretch=0.9},DefaultFeatures={Ligatures=Common}]{plex-otf}
### Docx output format
  docx:
    toc: true
    number-sections: true
    toc-depth: 2
---

# Цель работы

Целью данной работы является изучение принципов распределения и настройки адресного пространства на
устройствах сети.

# Задание

1. Выполнить задания по разбиению сети на подсети
2. Реализовать в GNS3 топологию сети, настроить IPv4-адресацию на устройствах первой подсети и проверить подключение между устройствами этой подсети, настроить IPv6-адресацию на устройствах второй подсети и проверить подключение между устройствами этой подсети, проанализировать захваченный на соединении сервера двойного стека адресации с коммутатором трафик ARP, ICMP, ICMPv6
3. Охарактеризовать подсети, указать, какие адреса в них входят, предложить вариант таблицы адресации для заданной топологии и адресного пространства, причём для интерфейсов маршрутизатора выбрать наименьший адрес в подсети, настроить IP-адресацию на маршрутизаторе VyOS и оконечных устройствах, причём на интерфейсах маршрутизатора установить наименьший адрес в подсети, проверить подключение между устройствами подсети с помощью команд ping и trace

# Выполнение лабораторной работы

## Разбиение сети на подсети

### Разбиение IPv4-сети на подсети

**№1.** Задана IPv4-сеть 172.16.20.0/24. Для заданной сети определите префикс, маску, broadcast-адрес, число возможных подсетей, диапазон адресов узлов. Разбейте сеть на 3 подсети с максимально возможным числом адресов узлов 126, 62, 62 соответственно.

**Выполнение задания №1:**

\begin{table}[H]
\centering
\caption{IPv4-сеть 172.16.20.0/24}
\label{table:table}
\begin{tabular}{|p{4cm}|p{4cm}|}
\hline
Адрес сети & 172.16.20.0/24 \\ \hline
Префикс & /24 \\ \hline
Маска & 255.255.255.0 \\ \hline
Broadcast-адрес & 172.16.20.255/24 \\ \hline
Число возможных подсетей & 256 \\ \hline
Диапазон адресов узлов & 172.16.20.1-172.16.20.254 \\ \hline
\end{tabular}
\end{table}

**Для вычисления broadcast-адреса ивертируем биты в сетевой части маски:**

- Маска: 11111111.11111111.11111111.00000000 (255.255.255.0)
- Инвертированная маска: 00000000.00000000.00000000.11111111 (0.0.0.255)
- Применим инвертированную маску к сети: 172.16.20.0 (сетевая часть) OR  0.0.0.255 (инвертированная маска) = **172.16.20.255**

**Первая подсеть:**

Потребуется 126 + 2 = 128 адресов (1 для адреса сети, 1 для broadcast-адреса)

Префикс маски: /25	т.к. (32 – 7 = 25)

Маска для такого количества адресов: 255.255.255.128

Адрес сети: 172.16.20.0

Broadcast-адрес (Широковещательный адрес): 

- Маска: 11111111.11111111.11111111.10000000 (255.255.255.128)
- Инвертированная маска: 00000000.00000000.00000000.01111111 (0.0.0.127)
- Применим инвертированную маску к сети: 172.16.20.0 (сетевая часть) OR  0.0.0.127 (инвертированная маска) = **172.16.20.127**

Диапазон адресов узлов: 172.16.20.1 - 172.16.20.126

**Вторая подсеть:**

Потребуется 62 + 2 = 64 адресов (1 для адреса сети, 1 для broadcast-адреса)

Префикс маски: /26	т.к. (32 – 6 = 26)

Маска для такого количества адресов: 255.255.255.192
Адрес сети: 172.16.20.128

Broadcast-адрес (Широковещательный адрес): 

- Маска: 11111111.11111111.11111111.11000000 (255.255.255.192)
- Инвертированная маска: 00000000.00000000.00000000.00111111 (0.0.0.63)
- Применим инвертированную маску к сети: 172.16.20.128 (сетевая часть) OR  0.0.0.63 (инвертированная маска) =  **172.16.20.191**

Диапазон адресов узлов: 172.16.20.129 - 172.16.20.190

**Третья подсеть:**

Потребуется 62 + 2 = 64 адресов (1 для адреса сети, 1 для broadcast-адреса)

Префикс маски: /26	т.к. (32 – 6 = 26)

Маска для такого количества адресов: 255.255.255.192

Адрес сети: 172.16.20.192

Broadcast-адрес (Широковещательный адрес): 

- Маска: 11111111.11111111.11111111.11000000 (255.255.255.192)
- Инвертированная маска: 00000000.00000000.00000000.00111111 (0.0.0.63)
- Применим инвертированную маску к сети: 172.16.20.192 (сетевая часть) OR  0.0.0.63 (инвертированная маска) = **172.16.20.255**

Диапазон адресов узлов: 172.16.20.193 — 172.16.20.254

**№2.** Задана сеть 10.10.1.64/26. Для заданной сети определите префикс, маску, broadcast-адрес, число возможных подсетей, диапазон адресов узлов. Выделите в этой сети подсеть на 30 узлов. Запишите характеристики для выделенной подсети.

**Выполнение задания №2:**

\begin{table}[H]
\centering
\caption{IPv4-сеть 10.10.1.64/26}
\label{table:table}
\begin{tabular}{|p{4cm}|p{4cm}|}
\hline
Адрес сети & 10.10.1.64/26 \\ \hline
Префикс & /26 \\ \hline
Маска & 255.255.255.192 \\ \hline
Broadcast-адрес & 10.10.1.127/26 \\ \hline
Число возможных подсетей & 64 \\ \hline
Диапазон адресов узлов & 10.10.1.65-10.10.1.126 \\ \hline
\end{tabular}
\end{table}

**Для вычисления broadcast-адреса ивертируем биты в сетевой части маски:**

- Маска: 11111111.11111111.11111111.11000000 (255.255.255.192)
- Инвертированная маска: 00000000.00000000.00000000.00111111 (0.0.0.63)
- Применим инвертированную маску к сети: 10.10.1.64 (сетевая часть) OR  0.0.0.63 (инвертированная маска) = **10.10.1.127**

**Подсеть на 30 узлов:**

Потребуется 30 + 2 = 32 адресов (1 для адреса сети, 1 для broadcast-адреса)

Префикс маски: /27	т.к. (32 – 5 = 27)

Маска для такого количества адресов: 255.255.255.224

Адрес сети: 10.10.1.64

Broadcast-адрес (Широковещательный адрес): 

- Маска: 11111111.11111111.11111111.11100000 (255.255.255.224)
- Инвертированная маска: 00000000.00000000.00000000.00011111 (0.0.0.31)
- Применим инвертированную маску к сети: 10.10.1.64 (сетевая часть) OR  0.0.0.31 (инвертированная маска) = **10.10.1.95**

Диапазон адресов узлов: 10.10.1.65 – 10.10.1.94

**№3.** Задана сеть 10.10.1.0/26. Для этой сети определите префикс, маску, broadcastадрес, число возможных подсетей, диапазон адресов узлов. Выделите в этой сети подсеть на 14 узлов. Запишите характеристики для выделенной подсети

**Выполнение задания №3:**

\begin{table}[H]
\centering
\caption{IPv4-сеть 10.10.1.0/26}
\label{table:table}
\begin{tabular}{|p{4cm}|p{4cm}|}
\hline
Адрес сети & 10.10.1.0/26 \\ \hline
Префикс & /26 \\ \hline
Маска & 255.255.255.192 \\ \hline
Broadcast-адрес & 10.10.1.63/26 \\ \hline
Число возможных подсетей & 64 \\ \hline
Диапазон адресов узлов & 10.10.1.1-10.10.1.62 \\ \hline
\end{tabular}
\end{table}

**Для вычисления broadcast-адреса ивертируем биты в сетевой части маски:**

- Маска: 11111111.11111111.11111111.11000000 (255.255.255.192)
- Инвертированная маска: 00000000.00000000.00000000.00111111 (0.0.0.63)
- Применим инвертированную маску к сети: 10.10.1.0 (сетевая часть) OR  0.0.0.63 (инвертированная маска) = **10.10.1.63**

**Подсеть на 14 узлов:**

Потребуется 14 + 2 = 16 адресов (1 для адреса сети, 1 для broadcast-адреса)

Префикс маски: /28	т.к. (32 – 4 = 28)

Маска для такого количества адресов: 255.255.255.240

Адрес сети: 10.10.1.0

Broadcast-адрес (Широковещательный адрес): 

- Маска: 11111111.11111111.11111111.11110000 (255.255.255.240)
- Инвертированная маска: 00000000.00000000.00000000.00001111 (0.0.0.15)
- Применим инвертированную маску к сети: 10.10.1.0 (сетевая часть) OR  0.0.0.15 (инвертированная маска) = **10.10.1.15**

Диапазон адресов узлов: 10.10.1.1 – 10.10.1.14
    
### Разбиение IPv6-сети на подсети

**№1.** Задана сеть 2001:db8:c0de::/48. Охарактеризуйте адрес, определите маску, префикс, диапазон адресов для узлов сети (краевые значения). Разбейте сеть на 2 подсети двумя способами — с использованием идентификатора подсети и с использованием идентификатора интерфейса. Поясните предложенные вами варианты разбиения.

**Выполнение задания №1:**

\begin{table}[H]
\centering
\caption{IPv6-сеть 2001:db8:c0de::/48}
\label{table:table}
\begin{tabular}{|p{4cm}|p{10cm}|}
\hline
Адрес сети & 2001:db8:c0de::/48 \\ \hline
Маска & ffff:ffff:ffff:0000:0000:0000:0000:0000 \\ \hline
Префикс & 2001:db8:c0de (первые 48 бит) \\ \hline
Диапазон адресов для узлов сети & 2001:db8:c0de:0000:0000:0000:0000:0000-2001:db8:c0de:ffff:ffff:ffff:ffff:ffff \\ \hline
\end{tabular}
\end{table}

Первые 48 бит фиксированы, т.е. префикс меет длину 48. Следующие 16 бит идентифицируют подсеть. Далее 64 бита содержат идентификатор конкретного интерфейса узла подсети.

**Разбиение на 2 подсети с использованием идентификатора подсети:**

- 2001:db8:c0de:0002::/64

- 2001:db8:c0de:0003::/64

**Разбиение на 2 подсети с использованием идентификатора интерфейса:**

Рекомендуется создавать подсеть на границе полубайта (4 бита или одна шестнадцатеричная цифра). Префикс подсети /64 расширяется на четыре бита (или один полубайт) до подсети /68

- 2001:db8:c0de:0000:1000::/68

- 2001:db8:c0de:0000:2000::/68

**№2.** Задана сеть 2a02:6b8::/64. Охарактеризуйте адрес, определите маску, префикс, диапазон адресов для узлов сети (краевые значения). Разбейте сеть на 2 подсети двумя способами — с использованием идентификатора подсети и с использованием идентификатора интерфейса. Поясните предложенные вами варианты разбиения.

**Выполнение задания №2:**

\begin{table}[H]
\centering
\caption{IPv6-сеть 2a02:6b8::/64}
\label{table:table}
\begin{tabular}{|p{4cm}|p{10cm}|}
\hline
Адрес сети & 2a02:6b8::/64 \\ \hline
Маска & ffff:ffff:ffff:ffff:0000:0000:0000:0000 \\ \hline
Префикс & 2a02:6b8:0:0 (первые 64 бит) \\ \hline
Диапазон адресов для узлов сети & 2a02:6b8:0000:0000:0000:0000:0000:0000-2a02:6b8:0000:0000:ffff:ffff:ffff:ffff \\ \hline
\end{tabular}
\end{table}

Первые 64 бит фиксированы, т.е. префикс меет длину 64. Далее 64 бита содержат идентификатор конкретного интерфейса узла подсети.

**Разбиение на 2 подсети с использованием идентификатора подсети:**

Этот способ не применим к сети /64, так как в ней уже нет отдельного 16-битного поля для идентификатора подсети. Он используется, когда исходная сеть — /48

**Разбиение на 2 подсети с использованием идентификатора интерфейса:**

Рекомендуется создавать подсеть на границе полубайта (4 бита или одна шестнадцатеричная цифра). Префикс подсети /64 расширяется на четыре бита (или один полубайт) до подсети /68

- 2a02:6b8:0000:0000:1000::/68

- 2a02:6b8:0000:0000:2000::/68

## Настройка двойного стека адресации IPv4 и IPv6 в локальной сети

\begin{table}[H]
\centering
\caption{Таблица адресации}
\label{table:table}
\begin{tabular}{|p{4cm}|p{4cm}|p{5cm}|p{3cm}|}
\hline
\textbf{Устройство} & \textbf{Интерфейс} & \textbf{IPv4-адрес} & \textbf{Шлюз по умолчанию} \\ \hline
gw-01 & eth0 & 172.16.20.1/25 & - \\ \hline
gw-01 & eth1 & 172.16.20.129/25 & - \\ \hline
gw-01 & eth2 & 64.100.1.1/24 & - \\ \hline
PC1 & NIC & 172.16.20.10/25 & 172.16.20.1 \\ \hline
PC2 & NIC & 172.16.20.138/25 & 172.16.20.129 \\ \hline
gw-02 & eth0 & 2001:db8:c0de:12::1/64 & - \\ \hline
gw-02 & eth1 & 2001:db8:c0de:13::1/64 & - \\ \hline
gw-02 & eth2 & 2001:db8:c0de:11::1/64 & - \\ \hline
PC3 & NIC & 2001:db8:c0de:12::a/64 & gw-02 \\ \hline
PC4 & NIC & 2001:db8:c0de:13::a/64 & gw-02 \\ \hline
Server & NIC & 64.100.1.10/24 & 64.100.1.1 \\ \hline
Server & NIC & 2001:db8:c0de:11::a/64 & gw-02 \\ \hline
\end{tabular}
\end{table}

Запустили GNS3 VM и GNS3. Создали новый проект. В рабочем пространстве разместили и соединили устройства в соответствии с топологией, приведённой в лабораторной работе. Для подсети IPv4 использовали маршрутизатор FRR, а для подсети с IPv6 — маршрутизатор VyOS.  Коммутаторам присвойте названия по принципу msk-oskalashnikova-sw-0x, маршрутизаторам — по принципу msk-oskalashnikova-gw-0x, VPCS — по принципу PCx-oskalashnikova, где x — порядковый номер устройства ([рис. @fig-001]) 

![Топология сети с двумя локальными подсетями (1)](image/1.png){#fig-001 width=70%}

Включили захват трафика на соединении между сервером двойного стека адресации и ближайшим к нему коммутатором ([рис. @fig-002]) 

![Захват трафика на соединении между сервером двойного стека адресации и ближайшим к нему коммутатором](image/2.png){#fig-002 width=70%}

Руководствуясь (табл. 3.6), настроили IPv4-адресацию для интерфейсов узлов PC1, PC2, Server:

- PC1 ([рис. @fig-003]):

```
ip 172.16.20.10/25 172.16.20.1
save
```

![Настройка IP-адреса на PC1](image/3.png){#fig-003 width=70%}

- PC2 ([рис. @fig-004]):

```
ip 172.16.20.138/25 172.16.20.129
save
```

![Настройка IP-адреса на PC2](image/4.png){#fig-004 width=70%}

- Server ([рис. @fig-005]):

```
ip 64.100.1.10/24 64.100.1.1
save
```

![Настройка IP-адреса на Server (1)](image/5.png){#fig-005 width=70%}

Посмотрели на PC1 и PC2 конфигурацию IPv4 и IPv6 ([рис. @fig-006]), ([рис. @fig-007]):

```
show ip
show ipv6
```

![Конфигурация IPv4 и IPv6 на PC1](image/6.png){#fig-006 width=70%}

![Конфигурация IPv4 и IPv6 на PC2](image/7.png){#fig-007 width=70%}

Руководствуясь (табл. 3.6), настроили IPv4-адресацию для интерфейсов локальной сети маршрутизатора FRR msk-oskalashnikova-gw-01 ([рис. @fig-008]):

```
frr# configure terminal
frr(config)# hostname msk-oskalashnikova-gw-01
msk-oskalashnikova-gw-01(config)# exit
msk-oskalashnikova-gw-01# write memory
msk-oskalashnikova-gw-01# configure terminal
msk-oskalashnikova-gw-01(config)# interface eth0
msk-oskalashnikova-gw-01(config-if)# ip address 172.16.20.1/25
msk-oskalashnikova-gw-01(config-if)# no shutdown
msk-oskalashnikova-gw-01(config-if)# exit
msk-oskalashnikova-gw-01(config)# interface eth1
msk-oskalashnikova-gw-01(config-if)# ip address 172.16.20.129/25
msk-oskalashnikova-gw-01(config-if)# no shutdown
msk-oskalashnikova-gw-01(config-if)# exit
msk-oskalashnikova-gw-01(config)# interface eth2
msk-oskalashnikova-gw-01(config-if)# ip address 64.100.1.1/24
msk-oskalashnikova-gw-01(config-if)# no shutdown
msk-oskalashnikova-gw-01(config-if)# exit
msk-oskalashnikova-gw-01(config)# exit
msk-oskalashnikova-gw-01# write memory
```

![Настройка IP-адреса на маршрутизаторе FRR](image/8.png){#fig-008 width=70%}

Проверили конфигурацию маршрутизатора и настройки IPv4-адресации ([рис. @fig-009]):

```
msk-oskalashnikova-gw-01# show running-config
msk-oskalashnikova-gw-01# show interface brief
```

![Проверка конфигурации маршрутизатора FRR и настройки IPv4-адресации](image/9.png){#fig-009 width=70%}

Далее проверили подключение с помощью команд ping и trace. Узлы PC1 и PC2 успешно отправляют эхо-запросы друг другу и на сервер с двойным стеком (Dual Stack Server) ([рис. @fig-010]), ([рис. @fig-011])

![Отправка эхо-запроса от PC1 к PC2 и к Server с помощью ping и trace](image/10.png){#fig-010 width=70%}

![Отправка эхо-запроса от PC2 к PC1 и к Server с помощью ping и trace](image/11.png){#fig-011 width=70%}

Руководствуясь (табл. 3.6), настроили IPv6-адресацию для интерфейсов узлов PC3, PC4, Server:

- PC3 ([рис. @fig-012]):

```
ip 2001:db8:c0de:12::a/64
save
```

![Настройка IP-адреса на PC3](image/12.png){#fig-012 width=70%}

- PC4 ([рис. @fig-013]):

```
ip 2001:db8:c0de:13::a/64
save
```

![Настройка IP-адреса на PC4](image/13.png){#fig-013 width=70%}

- Server ([рис. @fig-014]):

```
ip 2001:db8:c0de:11::a/64
save
```

![Настройка IP-адреса на Server (2)](image/14.png){#fig-014 width=70%}

Посмотрели на PC3 и PC4 конфигурацию IPv4 и IPv6 ([рис. @fig-015]), ([рис. @fig-016]):

```
show ip
show ipv6
```

![Конфигурация IPv4 и IPv6 на PC3](image/15.png){#fig-015 width=70%}

![Конфигурация IPv4 и IPv6 на PC4](image/16.png){#fig-016 width=70%}


Руководствуясь (табл. 3.6), настроили IPv6-адресацию для интерфейсов локальной сети маршрутизатора VyOS msk-oskalashnikova-gw-02:

- Перешли в режим конфигурирования, изменили имя устройства ([рис. @fig-017]):

```
vyos@vyos$ configure
vyos@vyos# set system host-name msk-oskalashnikova-gw-02
vyos@vyos# compare
vyos@vyos# commit
vyos@vyos# save
vyos@vyos# exit
vyos@vyos$ reboot
```

![Настройка имени устройства (1)](image/17.png){#fig-017 width=70%}

- Назначили IPv6-адреса маршрутизатору msk-oskalashnikova-gw-02 ([рис. @fig-018]), ([рис. @fig-019]), ([рис. @fig-020]):

```
vyos@msk-oskalashnikova-gw-02:~$ configure
vyos@msk-oskalashnikova-gw-02# set interfaces ethernet eth0 address 2001:db8:c0de:12::1/64
vyos@msk-oskalashnikova-gw-02# set service router-advert interface eth0 prefix 2001:db8:c0de:12::/64
vyos@msk-oskalashnikova-gw-02# set interfaces ethernet eth1 address 2001:db8:c0de:13::1/64
vyos@msk-oskalashnikova-gw-02# set service router-advert interface eth1 prefix 2001:db8:c0de:13::/64
vyos@msk-oskalashnikova-gw-02# set interfaces ethernet eth2 address 2001:db8:c0de:11::1/64
vyos@msk-oskalashnikova-gw-02# set service router-advert interface eth2 prefix 2001:db8:c0de:11::/64
```

![Настройка IP-адреса на маршрутизаторе VyOS (1)](image/18.png){#fig-018 width=70%}

![Проверка конфигцрации маршрутизатора VyOS и сохранение настроек IPv6-адресации](image/19.png){#fig-019 width=70%}

![Проверка настройки IPv6-адресации на маршрутизаторе VyOS](image/20.png){#fig-020 width=70%}

Проверили подключение с помощью команд ping и trace. Узлы PC3 и PC4 успешно отправляют эхо-запросы друг другу и на сервер с двойным стеком (Dual Stack Server) ([рис. @fig-021]), ([рис. @fig-022])

![Отправка эхо-запроса от PC3 к PC4 и к Server с помощью ping и trace](image/21.png){#fig-021 width=70%}

![Отправка эхо-запроса от PC4 к PC3 и к Server с помощью ping и trace](image/22.png){#fig-022 width=70%}

Убедились, что устройства из подсети IPv4 не доступны для устройств из подсети IPv6 и наоборот. Только сервер двойного стека может обращаться к устройствам обеих подсетей ([рис. @fig-023]), ([рис. @fig-024]), ([рис. @fig-025]), ([рис. @fig-026]), ([рис. @fig-027])

![Попытка подключения к PC3 и к PC4 с PC1](image/23.png){#fig-023 width=70%}

![Попытка подключения к PC3 и к PC4 с PC2](image/24.png){#fig-024 width=70%}

![Попытка подключения к PC1 и к PC2 с PC3](image/25.png){#fig-025 width=70%}

![Попытка подключения к PC1 и к PC2 с PC4](image/26.png){#fig-026 width=70%}

![Отправка эхо-запросов с Server к PC1, PC2, PC3 и PC4](image/27.png){#fig-027 width=70%}

Далее посмотрели захваченный на соединении сервера двойного стека адресации с коммутатором трафик ARP, ICMP, ICMPv6. Сеть работоспособна - есть двусторонняя связь, оба стека (IPv4/IPv6) активны, базовые протоколы работают корректно ([рис. @fig-028])

![Перехваченные пакеты](image/28.png){#fig-028 width=70%}

## Задание для самостоятельного выполнения

Создали новый проект. Задали топологию сети ([рис. @fig-029])

![Топология сети с двумя локальными подсетями (2)](image/29.png){#fig-029 width=70%}

Предполагается, что маршрутизатор разбивает сеть на две подсети с адресами IPv4 и IPv6:

- подсеть 1: 10.10.1.96/27; 2001:DB8:1:1::/64;
- подсеть 2: 10.10.1.16/28; 2001:DB8:1:4::/64.

Охарактеризовали подсети, укажем, какие адреса в них входят (табл. 3.7), (табл. 3.8):

\begin{table}[H]
\centering
\caption{Характеристики 1 и 2 подсети (IPv4)}
\label{table:table}
\begin{tabular}{|p{4cm}|p{4cm}|p{4cm}|}
\textbf{} & \textbf{1 подсеть} & \textbf{2 подсеть} \\
\hline
Адрес сети & 10.10.1.96/27 & 10.10.1.16/28 \\ \hline
Префикс & /27 & /28 \\ \hline
Маска & 255.255.255.224 & 255.255.255.240 \\ \hline
Broadcast-адрес & 10.10.1.127/27 & 10.10.1.31/28 \\ \hline
Число возможных подсетей & 32 & 16 \\ \hline
Диапазон адресов узлов & 10.10.1.97-10.10.1.126 & 10.10.1.17-10.10.1.30 \\ \hline
\end{tabular}
\end{table}

Вычисления broadcast-адреса для 1 подсети:

- Маска: 11111111.11111111.11111111.11100000 (255.255.255.224)
- Инвертированная маска: 00000000.00000000.00000000.00011111 (0.0.0.31)
- Применим инвертированную маску к сети: 10.10.1.96 (сетевая часть) OR  0.0.0.31 (инвертированная маска) = **10.10.1.127**

Вычисления broadcast-адреса для 2 подсети:

- Маска: 11111111.11111111.11111111.11110000 (255.255.255.240)
- Инвертированная маска: 00000000.00000000.00000000.00001111 (0.0.0.15)
- Применим инвертированную маску к сети: 10.10.1.16 (сетевая часть) OR  0.0.0.15 (инвертированная маска) = **10.10.1.31**

\begin{table}[H]
\centering
\caption{Характеристики 1 и 2 подсети (IPv6)}
\label{table:table}
\begin{tabular}{|p{3cm}|p{7cm}|p{7cm}|}
\textbf{} & \textbf{1 подсеть} & \textbf{2 подсеть} \\
\hline
Адрес сети & 2001:DB8:1:1::/64 & 2001:DB8:1:4::/64 \\ \hline
Маска & ffff:ffff:ffff:ffff:0000:0000:0000:0000 & ffff:ffff:ffff:ffff:0000:0000:0000:0000 \\ \hline
Префикс & 2001:DB8:1:1 & 2001:DB8:1:4 \\ \hline
Диапазон адресов для узлов сети & 2001:DB8:1:1:0000:0000:0000:0000-2001:DB8:1:1:ffff:ffff:ffff:ffff & 2001:DB8:1:4:0000:0000:0000:0000-2001:DB8:1:4:ffff:ffff:ffff:ffff \\ \hline
\end{tabular}
\end{table}

Предложили вариант таблицы адресации для заданной топологии и адресного пространства, причём для интерфейсов маршрутизатора выбрать наименьший адрес в подсети (тaбл. 3.9):

\begin{table}[H]
\centering
\caption{Вариант таблицы адресации}
\label{tab:table}
\begin{tabular}{|p{3cm}|p{2cm}|p{3cm}|p{4cm}|p{3cm}|}
\textbf{Устройство} & \textbf{Интерфейс} & \textbf{IPv4} & \textbf{IPv6} & \textbf{Шлюз по умолчанию} \\
\hline
PC1-oskalashnikova & NIC & 10.10.1.98/27 & 2001:db8:1:1::2/64 & 10.10.1.97 \\ \hline
PC2-oskalashnikova & NIC & 10.10.1.18/28 & 2001:db8:1:4::2/64 & 10.10.1.17 \\ \hline
msk-oskalashnikova-gw-01 & eth0 & 10.10.1.97/27 & 2001:db8:1:1::1/64 & - \\ \hline
msk-oskalashnikova-gw-01 & eth1 & 10.10.1.17/28 & 2001:db8:1:4::1/64 & - \\ \hline
\end{tabular}
\end{table}

Задали IP-адреса для PC1 ([рис. @fig-030]):

```
ip 10.10.1.98/27 10.10.1.97
save
ip 2001:db8:1:1::2/64
save
```

![Настройка IP-адреса на PC1-oskalashnikova](image/30.png){#fig-030 width=70%}

Задали IP-адреса для PC2 ([рис. @fig-031]):

```
ip 10.10.1.18/28 10.10.1.17
save
ip 2001:db8:1:4::2/64
save
```

![Настройка IP-адреса на PC2-oskalashnikova](image/31.png){#fig-031 width=70%}

Настроили IP-адреса интерфейсов маршрутизатора msk-oskalashnikova-gw-01:

- Перешли в режим конфигурирования, изменили имя устройства ([рис. @fig-032]):

```
vyos@vyos$ configure
vyos@vyos# set system host-name msk-oskalashnikova-gw-01
vyos@vyos# compare
vyos@vyos# commit
vyos@vyos# save
vyos@vyos# exit
vyos@vyos$ reboot
```

![Настройка имени устройства (2)](image/32.png){#fig-032 width=70%}

- Назначили IPv6 и IPv4-адреса интерфейсам маршрутизатора msk-oskalashnikova-gw-01 ([рис. @fig-033]), ([рис. @fig-034]), ([рис. @fig-035]), ([рис. @fig-036]):

```
vyos@msk-oskalashnikova-gw-01:~$ configure
vyos@msk-oskalashnikova-gw-01:~$ delete interfaces ethernet eth0 address dhcp
vyos@msk-oskalashnikova-gw-01:~$ delete interfaces ethernet eth0 address 10.10.1.97/27
vyos@msk-oskalashnikova-gw-01:~$ delete interfaces ethernet eth1 address 10.10.1.17/28
vyos@msk-oskalashnikova-gw-01# set interfaces ethernet eth0 address 2001:db8:1:1::1/64
vyos@msk-oskalashnikova-gw-01# set service router-advert interface eth0 prefix 2001:db8:1:1::/64
vyos@msk-oskalashnikova-gw-01# set interfaces ethernet eth1 address 2001:db8:1:4::1/64
vyos@msk-oskalashnikova-gw-01# set service router-advert interface eth1 prefix 2001:db8:1:4::/64
```

![Настройка IP-адреса на маршрутизаторе VyOS (2)](image/33.png){#fig-033 width=70%}

![Проверка конфигцрации маршрутизатора VyOS (2)](image/34.png){#fig-034 width=70%}

![Сохранение настроек IPv6 и IPv4-адресации на маршрутизаторе VyOS](image/35.png){#fig-035 width=70%}

![Проверка настройки IPv6 и IPv4-адресации на маршрутизаторе VyOS](image/36.png){#fig-036 width=70%}

Проверили подключение между устройствами подсети с помощью команд ping и trace ([рис. @fig-037]), ([рис. @fig-038])

![Отправка эхо-запроса от PC1 к PC2](image/37.png){#fig-037 width=70%}

![Отправка эхо-запроса от PC2 к PC1](image/38.png){#fig-038 width=70%}

# Выводы

В ходе выполнения лабораторной работы №6 мы изучили принципы распределения и настройки адресного пространства на устройствах сети.

# Список литературы

1. [Лаборатораня работа №6](https://esystem.rudn.ru/pluginfile.php/2858379/mod_resource/content/2/006-lab_ipv4-ipv6-addr-GNS3.pdf)
