---
# Preamble

## Author
author:
  name: Калашникова Ольга Сергеевна
  email: 1132231846@rudn.ru
  affiliation:
    - name: Российский университет дружбы народов
      country: Российская Федерация
      postal-code: 117198
      city: Москва
      address: ул. Миклухо-Маклая, д. 6
## Title
title: "Отчёт по лабораторной работе №3"
subtitle: "Дисциплина: Сетевые технологии"
license: "CC BY"
## Generic options
lang: ru-RU
number-sections: true
toc: true
toc-title: "Содержание"
toc-depth: 2
## Crossref customization
crossref:
  lof-title: "Список иллюстраций"
  lot-title: "Список таблиц"
  lol-title: "Листинги"
## Bibliography
bibliography:
  - bib/cite.bib
csl: _resources/csl/gost-r-7-0-5-2008-numeric.csl
## Formats
format:
### Pdf output format
  pdf:
    toc: true
    number-sections: true
    colorlinks: false
    toc-depth: 2
    lof: true # List of figures
    lot: true # List of tables
#### Document
    documentclass: scrreprt
    papersize: a4
    fontsize: 12pt
    linestretch: 1.5
#### Language
    babel-lang: ru
    babel-otherlangs: en
#### Biblatex
    cite-method: biblatex
    biblio-style: gost-numeric
    biblatexoptions:
      - backend=biber
      - langhook=extras
      - autolang=other*
#### Misc options
    csquotes: true
    indent: true
    header-includes: |
      \usepackage{indentfirst}
      \usepackage{float}
      \floatplacement{figure}{H}
      \usepackage[math,RM={Scale=0.94},SS={Scale=0.94},SScon={Scale=0.94},TT={Scale=MatchLowercase,FakeStretch=0.9},DefaultFeatures={Ligatures=Common}]{plex-otf}
### Docx output format
  docx:
    toc: true
    number-sections: true
    toc-depth: 2
---

# Цель работы

Изучение посредством Wireshark кадров Ethernet, анализ PDU протоколов транспортного и прикладного уровней стека TCP/IP

# Задание

1. Изучение возможностей команды ipconfig для ОС типа Windows (ifconfigдля систем типа Linux).

2. Определение MAC-адреса устройства и его типа

3. Установить на домашнем устройстве Wireshark.

4. С помощью Wireshark захватить и проанализировать пакеты ARP и ICMP в части кадров канального уровня.

5. С помощью Wireshark захватить и проанализировать пакеты HTTP, DNS в части заголовков и информации протоколов TCP, UDP, QUIC

6. С помощью Wireshark проанализировать handshake протокола TCP

# Выполнение лабораторной работы

## MAC-адресация

Была получена информация о сетевых интерфейсах компьютера с помощью команды `ipconfig /all`. Скриншот показывает детальную конфигурацию беспроводного адаптера, включая его физический адрес (MAC-адрес), IPv4-адрес, шлюз по умолчанию и DHCP-сервер.

![Информация о сетевых интерфейсах](image/1.png)

Для понимания структуры MAC-адреса была изучена схема его устройства. MAC-адрес состоит из 6 октетов (байтов). Первые три октета представляют собой уникальный идентификатор организации (OUI), назначенный производителю оборудования. Последние три октета являются уникальным идентификатором сетевого интерфейса (NIC Specific), назначаемым производителем. В структуре также важны отдельные биты: младший бит первого октета указывает на тип адреса (unicast/multicast), а следующий бит определяет, является ли адрес глобально уникальным или локально администрируемым.

![Структура MAC-адреса](image/2.png)

На основании данных, полученных из `ipconfig`, был проанализирован MAC-адрес беспроводного адаптера: `8C-B8-7E-1B-8A-F0`. Первые три октета `8C-B8-7E` представляют OUI, зарегистрированный за компанией Intel. Анализ битовой структуры первого октета (`8C` в шестнадцатеричной системе, что соответствует `10001100` в двоичной) показывает, что младший бит равен `0`, что указывает на индивидуальный (unicast) адрес. Следующий бит также равен `0`, что означает, что адрес является глобально уникальным, назначенным производителем (factory default), а не локально администрируемым.

## Анализ кадров канального уровня в Wireshark

Был запущен анализатор трафика Wireshark. На скриншоте представлено стартовое окно программы, где необходимо выбрать сетевой интерфейс для захвата трафика. В данном случае выбран интерфейс беспроводной сети.

![Интерфейс Wireshark](image/3.png)

Для генерации сетевого трафика на исследуемом компьютере была выполнена команда `ping 192.168.0.1 -n 3` в командной строке. Команда отправляет три ICMP Echo-запроса на адрес шлюза по умолчанию (192.168.0.1). В результате получены три ответа со временем отклика от 1 до 48 мс, что подтверждает работоспособность соединения.

![Выполнение команды ping](image/4.png)

В Wireshark был начат захват трафика. После его остановки к списку пакетов применен фильтр отображения `arp or icmp`. На скриншоте виден отфильтрованный список, содержащий только пакеты протоколов ARP и ICMP. Строка заголовка таблицы показывает основные поля: номер пакета, время, адрес источника, адрес назначения, протокол, длина и краткая информация.

![Общий список пакетов](image/5.png)

Выбран первый ICMP Echo-запрос (пакет №18454). В детальном разборе кадра видно, что его полная длина на проводе составляет 74 байта. Это кадр типа Ethernet II. Адресом источника (Source) является MAC-адрес сетевой карты компьютера `8c:b8:7e:1b:8a:f0` (Intel_1b:8a:f0). Адресом назначения (Destination) выступает MAC-адрес роутера `40:ae:30:8b:ce:c5` (TPLink_8b:ce:c5). Оба адреса являются индивидуальными (unicast) и глобально уникальными.

![ICMP Echo Request](image/6.png)

В ответ на запрос был захвачен ICMP Echo-ответ (пакет №18455). Его структура аналогична запросу: длина 74 байта, тип Ethernet II. Ключевое отличие в адресах: теперь источником (Src) является роутер (`40:ae:30:8b:ce:c5`), а назначением (Dst) — компьютер (`8c:b8:7e:1b:8a:f0`). Это демонстрирует двусторонний обмен данными на канальном уровне с использованием физических адресов.

![ICMP Echo Reply](image/7.png)

В захваченном трафике обнаружен ARP-запрос (пакет №17969). В общей таблице пакетов видно, что это широковещательный запрос "Who has 192.168.0.111? Tell 192.168.0.1". Это означает, что устройство с IP-адресом 192.168.0.1 (шлюз) ищет MAC-адрес устройства с IP-адресом 192.168.0.111.

![ARP-запрос в общем списке](image/8.png)

Детальный разбор этого ARP-запроса (Frame 17969) показывает, что длина кадра составляет 42 байта. В заголовке Ethernet II видно, что адрес назначения (Destination) — это широковещательный адрес `ff:ff:ff:ff:ff:ff`. Адрес источника (Source) — MAC роутера `40:ae:30:8b:ce:c5`. Тип кадра указан как ARP (0x0806). Это подтверждает, что ARP-запросы всегда отправляются на широковещательный адрес, так как отправителю неизвестен физический адрес целевого устройства.

![Детали ARP-запроса](image/9.png)

Следующим в логе идет ARP-ответ (пакет №17970). В таблице видно сообщение "192.168.0.111 is at 8c:b8:7e:1b:8a:f0". Это прямой ответ от компьютера с IP 192.168.0.111, содержащий его MAC-адрес.

![ARP-ответ в общем списке](image/10.png)

Детальный разбор ARP-ответа (Frame 17970) показывает его структуру. Длина также 42 байта. Адрес назначения (Destination) теперь является индивидуальным адресом роутера `40:ae:30:8b:ce:c5`, а источником (Source) — MAC-адрес компьютера `8c:b8:7e:1b:8a:f0`. Это демонстрирует, что ARP-ответы отправляются напрямую отправителю запроса, используя уже известный MAC-адрес, и не являются широковещательными.

![Детали ARP-ответа](image/11.png)

Для проверки связи с внешним узлом была выполнена команда ping до адреса 5.255.255.77. На скриншоте виден фрагмент лога Wireshark, где зафиксированы ICMP-запросы с компьютера (192.168.0.111) на внешний адрес и соответствующие ответы. Также видно, что периодически возникают ARP-запросы от шлюза для подтверждения MAC-адреса компьютера, что является нормальным поведением протокола ARP.

![Ping внешнего адреса](image/12.png)

Детальный разбор одного из ICMP-запросов к внешнему адресу (Frame 211) показывает, что структура пакета аналогична ping до шлюза. MAC-адресом источника является компьютер (`8c:b8:7e:1b:8a:f0`), а назначения — роутер (`40:ae:30:8b:ce:c5`). Это подтверждает, что связь с любым внешним IP-адресом на канальном уровне сначала осуществляется через шлюз по умолчанию.

![ICMP запрос внешнему адресу](image/13.png)

Соответствующий ICMP-ответ от внешнего адреса (Frame 212) также проходит через шлюз. На канальном уровне источником пакета является роутер (`40:ae:30:8b:ce:c5`), а назначением — компьютер (`8c:b8:7e:1b:8a:f0`). При этом IP-адреса в заголовке сетевого уровня соответствуют внешнему узлу (5.255.255.77) и компьютеру (192.168.0.111).

![ICMP ответ от внешнего адреса](image/14.png)

## Анализ протоколов транспортного уровня в Wireshark

Был выполнен переход на сайт, работающий по протоколу HTTP. На скриншоте виден фрагмент лога Wireshark, где зафиксированы HTTP-запросы и ответы. Видны запросы к сайту info.cern.ch, включая GET-запрос для получения страницы `/hypertext/TBL_Disclaimer.html` и ответ сервера с кодом 200 OK.

![HTTP трафик в общем списке](image/15.png)

Выбран HTTP-запрос (Frame 5181). В детальном разборе видно, что это TCP-сегмент с установленными флагами PSH (Push) и ACK (Acknowledgment). Длина сегмента составляет 474 байта. Порт источника - 63302 (клиентский порт), порт назначения - 80 (стандартный порт HTTP). Относительный порядковый номер (Sequence Number) равен 1, номер подтверждения (Acknowledgement Number) также равен 1. Это указывает на то, что TCP-соединение уже установлено, и происходит передача данных прикладного уровня.

![Детали HTTP запроса](image/16.png)

Выбран соответствующий HTTP-ответ от сервера (Frame 5184). Это также TCP-сегмент с флагами PSH и ACK длиной 1053 байта. Порт источника - 80 (сервер), порт назначения - 63302 (клиент). Относительный порядковый номер равен 1, а номер подтверждения - 475. Это подтверждает получение сервером всех 474 байтов данных из запроса и начало передачи ответа. Поле окна (Window) показывает размер свободного буфера получателя.

![Детали HTTP ответа](image/17.png)

Применен фильтр `dns` для отображения только DNS-трафика. На скриншоте виден список DNS-запросов и ответов. Видны запросы на разрешение имен различных доменов: sec.api.browser.yandex.ru, tracker.aler.com, api.browser.yandex.ru, info.cern.ch и др. Для каждого запроса обычно следует два типа запросов: тип A (для IPv4-адресов) и тип HTTPS (для служб, использующих HTTPS). В ответах содержатся IP-адреса или CNAME-записи.

![DNS трафик в общем списке](image/18.png)

Выбран DNS-запрос типа A для домена mc.yandex.ru (Frame 505). В детальном разборе видно, что этот пакет использует протокол UDP. Порт источника - 57117 (эфемерный порт клиента), порт назначения - 53 (стандартный порт DNS). Длина UDP-датаграммы составляет 38 байт. DNS-запрос содержит идентификатор транзакции 0x3655 и запрашивает запись типа A для домена mc.yandex.ru.

![Детали DNS запроса](image/19.png)

Выбран соответствующий DNS-ответ (Frame 510). Это UDP-датаграмма от сервера (порт 53) клиенту (порт 57117) длиной 86 байт. Ответ содержит тот же идентификатор транзакции 0x3655. В ответе указаны два IP-адреса для домена mc.yandex.ru: 87.250.251.119 и 77.88.x.x (адрес обрезан на скриншоте). Это демонстрирует работу DNS по протоколу UDP - простой обмен датаграммами без установления соединения.

![Детали DNS ответа](image/20.png)

Применен фильтр `quic` для отображения пакетов протокола QUIC. На скриншоте видна серия пакетов QUIC от адреса 94.181.150.79 к 192.168.0.111. Все пакеты имеют одинаковую длину 1242 байта и тип "Initial". В информации указан Destination Connection ID (DCID) - 78e79846bbf37984, и нулевой номер пакета (PKN: 0). Это начальные пакеты установления соединения QUIC.

![QUIC трафик в общем списке](image/21.png)

Выбран один из пакетов QUIC для детального анализа. В заголовке QUIC видно, что это пакет с длинным заголовком (Long Header), тип пакета - Initial. Версия протокола указана как 1. Destination Connection ID имеет длину 8 байт и значение 78e79846bbf37984. Длина полезной нагрузки составляет 1182 байта. Номер пакета равен 0. QUIC работает поверх UDP, что видно по заголовку User Datagram Protocol с портом источника 27692 и портом назначения 6881.

![Детали QUIC пакета](image/22.png)

## Анализ handshake протокола TCP в Wireshark

Для анализа процесса установления TCP-соединения выбран участок трафика, где клиент (192.168.0.111) соединяется с веб-сервером (188.184.67.127) на порт 80. На скриншоте видна последовательность пакетов: сначала клиент отправляет пакет с флагом SYN (пакет 27947), затем сервер отвечает пакетом с флагами SYN, ACK (пакет 27949), и наконец клиент отправляет пакет с флагом ACK (пакет 27950). Это классическое трехэтапное рукопожатие TCP (three-way handshake). После установления соединения следует HTTP-запрос и передача данных.

![TCP handshake в общем списке](image/23.png)

Выбран первый пакет трехэтапного рукопожатия - SYN-пакет от клиента (Frame 27947). В детальном разборе TCP-сегмента видно, что установлен только флаг SYN (Synchronize). Порт источника - 55567 (эфемерный порт клиента), порт назначения - 80 (HTTP). Начальный порядковый номер (Sequence Number) равен 0 (в относительном представлении). Размер окна (Window) составляет 65535 байт. В параметрах TCP указаны MSS (Maximum Segment Size) = 1460 байт и SACK (Selective Acknowledgment) разрешен.

![Детали TCP SYN пакета](image/24.png)

Выбран второй пакет трехэтапного рукопожатия - SYN-ACK пакет от сервера (Frame 27949). В детальном разборе видно, что установлены флаги SYN и ACK. Сервер подтверждает получение SYN-пакета от клиента: номер подтверждения (Acknowledgment Number) равен 1 (на единицу больше начального порядкового номера клиента). В то же время сервер устанавливает свой собственный начальный порядковый номер (Sequence Number), равный 0. Размер окна сервера составляет 64240 байт.

![Детали TCP SYN-ACK пакета](image/25.png)

Выбран третий пакет трехэтапного рукопожатия - ACK пакет от клиента (Frame 27950). В этом пакете установлен только флаг ACK. Клиент подтверждает получение SYN-пакета от сервера: номер подтверждения равен 1 (на единицу больше начального порядкового номера сервера). Порядковый номер клиента теперь также равен 1. После отправки этого пакета TCP-соединение считается установленным, и стороны могут начинать передачу данных. На скриншоте видно, что сразу после этого следует HTTP-запрос.

![Детали TCP ACK пакета](image/26.png)

В Wireshark в меню «Статистика» выбрали «График Потока». На графике визуально представлен обмен пакетами между клиентом и сервером в рамках TCP-соединения. По горизонтальной оси отложено время, по вертикальной - порядковые номера пакетов. На графике четко видны три этапа установления соединения: первый сегмент от клиента к серверу (SYN), ответ от сервера (SYN-ACK) и завершающее подтверждение от клиента (ACK). После установления соединения наблюдается интенсивный обмен данными с постепенным увеличением порядковых номеров, что соответствует передаче содержимого веб-страницы. Наклон линий на графике показывает скорость передачи данных.

![График потока TCP](image/27.png)

# Вывод

В ходе выполнения лабораторной работы посредством Wireshark были изучены кадры Ethernet, был проведён анализ PDU протоколов транспортного и прикладного уровней стека TCP/IP
